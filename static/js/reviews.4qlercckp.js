(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{234:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Tabs});__webpack_require__(3),__webpack_require__(4),__webpack_require__(7),__webpack_require__(36),__webpack_require__(8),__webpack_require__(1),__webpack_require__(0),__webpack_require__(83),__webpack_require__(2),__webpack_require__(5),__webpack_require__(6);var _tab_line_tab_line__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(64),gsap_TweenLite__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(9);function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Tabs=function(){function Tabs(links,_ref){var linkClass=_ref.linkClass,tabsClass=_ref.tabsClass,_ref$callback=_ref.callback,callback=void 0===_ref$callback?function(f){return f}:_ref$callback,line=_ref.line,_ref$beforeChange=_ref.beforeChange,beforeChange=void 0===_ref$beforeChange?function(f){return f}:_ref$beforeChange,_ref$afterChange=_ref.afterChange,afterChange=void 0===_ref$afterChange?function(f){return f}:_ref$afterChange;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Tabs),this.classes={heading:{active:"".concat(linkClass,"_is_active"),item:"".concat(linkClass)},content:{active:"".concat(tabsClass,"_is_active"),show:"".concat(tabsClass,"_is_show"),item:"".concat(tabsClass)}},this.state={activeLink:null,activeTab:null},this.links=links,this.line=line?new _tab_line_tab_line__WEBPACK_IMPORTED_MODULE_11__.a({line:line,buttons:this.links,bindClick:!0}):null,this.beforeChange=beforeChange,this.afterChange=afterChange,this.callback=callback}var Constructor,protoProps,staticProps;return Constructor=Tabs,(protoProps=[{key:"init",value:function(){this.handlers()}},{key:"handlers",value:function(){var _this=this;this.tabs=_toConsumableArray(this.links).reduce(function(acc,element){var tab=document.querySelector(element.getAttribute("href"));return tab&&acc.push(tab),element.addEventListener("click",function(event){event.preventDefault();var result=_this.beforeChange(element,tab);result?Promise.resolve(result).then(function(){_this.toggleTab(element,tab),_this.callback(element,tab)}):(_this.toggleTab(element,tab),_this.callback(element,tab))}),acc},[]),this.state.activeLink=this.links.find(function(link){return link.classList.contains(_this.classes.heading.active)}),this.state.activeTab=this.tabs.find(function(tab){return tab.classList.contains(_this.classes.content.active)})}},{key:"toggleTab",value:function(link,target){target&&(this.activeLink=link,this.activeTab=target)}},{key:"setActiveTab",value:function(tab){var _this2=this;this.state.activeTab=tab,this.state.activeTab.classList.add(this.classes.content.active),gsap_TweenLite__WEBPACK_IMPORTED_MODULE_12__.c.fromTo(this.state.activeTab,.25,{opacity:0,y:10},{opacity:1,y:0,onComplete:function(){_this2.state.activeTab.classList.add(_this2.classes.content.show)}})}},{key:"activeLink",set:function(link){this.state.activeLink&&this.state.activeLink.classList.remove(this.classes.heading.active),this.state.activeLink=link,this.state.activeLink.classList.add(this.classes.heading.active)},get:function(){return this.state.activeLink}},{key:"activeTab",set:function(tab){var _this3=this;this.state.activeTab?(this.state.activeTab.classList.remove(this.classes.content.show),gsap_TweenLite__WEBPACK_IMPORTED_MODULE_12__.c.to(this.state.activeTab,.3,{opacity:0,y:10,onComplete:function(){_this3.state.activeTab.classList.remove(_this3.classes.content.active),_this3.setActiveTab(tab),_this3.afterChange(tab)}})):this.setActiveTab(tab)},get:function(){return this.state.activeTab}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Tabs}()},399:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(3),__webpack_require__(4),__webpack_require__(7),__webpack_require__(8),__webpack_require__(1),__webpack_require__(0),__webpack_require__(83),__webpack_require__(165),__webpack_require__(2),__webpack_require__(5),__webpack_require__(10),__webpack_require__(6);var axios=__webpack_require__(28),axios_default=__webpack_require__.n(axios);function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var AvatarForm=function(){function AvatarForm(element){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AvatarForm),this.element=element,this.image=this.element.querySelector(".avatar-form-n-2__preview"),this.input=this.element.querySelector('input[name="my-image"]'),this.hiddenInput=this.element.querySelector('input[name="avatar"]'),this.defaultImages=_toConsumableArray(this.element.querySelectorAll(".avatar-form-n-2__defaults .avatar-form-n-2__preview")),this.bindEvents()}return _createClass(AvatarForm,null,[{key:"init",value:function(){return _toConsumableArray((arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).querySelectorAll(".js-avatar-form")).forEach(function(element){new AvatarForm(element)})}}]),_createClass(AvatarForm,[{key:"bindEvents",value:function(){var _this=this;this.image.addEventListener("click",function(){_this.element.classList.toggle("is-active")}),this.defaultImages.forEach(function(el){el.addEventListener("click",function(){var defaultStyle=el.getAttribute("data-style");el.classList.add("is-checked"),_this.defaultImages.forEach(function(element){element!==el&&element.classList.remove("is-checked")}),_this.hiddenInput.value=defaultStyle,_this.image.setAttribute("data-style",defaultStyle),_this.image.innerHTML=""})}),this.input.addEventListener("change",function(event){var files=_toConsumableArray(event.target.files);if(files&&files[0]){var reader=new FileReader;reader.onload=function(){var image=document.createElement("img");image.src=reader.result,_this.defaultImages.forEach(function(element){element.classList.remove("is-checked")}),_this.hiddenInput.value=reader.result,_this.image.removeAttribute("data-style"),_this.image.innerHTML="",_this.image.appendChild(image)},reader.readAsDataURL(files[0])}}),document.body.addEventListener("click",function(event){event.target.closest(".avatar-form-n-2")||_this.element.classList.remove("is-active")})}}]),AvatarForm}();__webpack_require__(84),__webpack_require__(54),__webpack_require__(21),__webpack_require__(55),__webpack_require__(85);function feedback_form_upload_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function feedback_form_upload_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var FeedbackFormUpload=function(){function FeedbackFormUpload(formController){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FeedbackFormUpload),this.controller=formController,this.formUploadsWrappers=feedback_form_upload_toConsumableArray(this.controller.form.querySelectorAll(".js-upload-wrap")),this.formFileInputs=feedback_form_upload_toConsumableArray(this.controller.form.querySelectorAll(".js-upload-target")),this.formUploadInputs=feedback_form_upload_toConsumableArray(this.controller.form.querySelectorAll(".js-upload-input")),this.formErrorContainer=this.controller.form.querySelector(".js-upload-error"),this.inputsCollection=[],this.uploadsCollection=[],this.uploadsCount=0,this.bindEvents()}var Constructor,protoProps,staticProps;return Constructor=FeedbackFormUpload,(protoProps=[{key:"bindEvents",value:function(){var _this=this;this.formUploadsWrappers.forEach(function(el){var trigger=el.querySelector(".js-upload-file-trigger"),previews=el.querySelector(".js-upload-file-target"),container=el.querySelector(".js-upload-input");trigger.addEventListener("click",function(event){event.preventDefault(),_this.uploadFile(container,previews)})})}},{key:"bindPreviewEvents",value:function(){var _this2=this;this.formUploadsWrappers.forEach(function(el){feedback_form_upload_toConsumableArray(el.querySelectorAll(".attached-file__close")).forEach(function(element){element.addEventListener("click",function(){var index=element.parentNode.getAttribute("data-file-index");_this2.formUploadsWrappers.forEach(function(wrapper){feedback_form_upload_toConsumableArray(wrapper.querySelectorAll('[data-file-index="'.concat(index,'"'))).forEach(function(elem){elem.parentNode.removeChild(elem)})}),_this2.uploadsCollection=_this2.uploadsCollection.filter(function(upload){return upload.key!==+index}),_this2.validateFilesSize()})})})}},{key:"createItemPreview",value:function(fileExtension,image){return'\n      <div class="attached-file" title="Изображение" data-file-index="'.concat(this.uploadsCount,'">\n        <div class="attached-file__close">\n          <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10" fill="none">\n            <path stroke="#071321" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1l8 8M9 1L1 9"/>\n          </svg>\n        </div>\n        <div class="attached-file__img">\n          ').concat(image||"",'\n          <div class="attached-file__tag">').concat(fileExtension,'</div>\n        </div>\n        <div class="attached-file__title">').concat(this.getTitle(fileExtension),"</div>\n      </div>\n    ")}},{key:"getTitle",value:function(fileExtension){return"jpg"===fileExtension||"png"===fileExtension?"Изображение":"txt"===fileExtension||"docx"===fileExtension||"doc"===fileExtension||"pdf"===fileExtension?"Документ":"xlsx"===fileExtension||"xls"===fileExtension?"Таблица":"ppt"===fileExtension||"pps"===fileExtension||"pptx"===fileExtension?"Презентация":void 0}},{key:"validateFilesSize",value:function(){var fileSize=0;this.uploadsCollection.forEach(function(upload){fileSize+=upload.file.size}),fileSize/1024/1024>3?(this.formErrorContainer.innerHTML="Размер прикрепленных файлов больше 3мб",this.formErrorContainer.style.display="",this.controller.formSubmit.disabled=!0):(this.formErrorContainer.innerHTML="",this.formErrorContainer.style.display="none",this.controller.formSubmit.disabled=!1)}},{key:"uploadFile",value:function(container,view){var _this3=this;feedback_form_upload_toConsumableArray(container.querySelectorAll('input[type="file"]')).forEach(function(el){0===el.value.length&&el.parentNode.removeChild(el)});var input=document.createElement("input");input.setAttribute("type","file"),input.setAttribute("accept","image/jpeg, image/png, image/gif, image/bmp, .xlsx, .xls, .doc, .docx, .txt, .pdf"),input.setAttribute("name","files[]"),input.setAttribute("multiple","multiple"),input.setAttribute("data-url","/ajax/comments_file.php"),input.setAttribute("data-file-index",++this.uploadsCount),input.setAttribute("multiple","true"),input.addEventListener("change",function(event){feedback_form_upload_toConsumableArray(event.target.files).forEach(function(file){var extension=file.name.split(".").pop().toLowerCase(),reader=new FileReader;reader.readAsDataURL(file),reader.onload=function(){var image="";["jpg","png"].includes(extension)&&(image='<img class="thumb" src="'.concat(reader.result,'" />'));var input2=document.createElement("input");input2.setAttribute("name","files_array[][".concat(_this3.uploadsCount,"]")),input2.setAttribute("type","hidden"),input2.setAttribute("data-file-index",_this3.uploadsCount),container.appendChild(input2),_this3.inputsCollection.push(input2),view.innerHTML+=_this3.createItemPreview(extension,image),_this3.uploadsCollection.push({key:_this3.uploadsCount,file:file}),_this3.bindPreviewEvents(),_this3.validateFilesSize()}})}),container.appendChild(input),this.inputsCollection.push(input),input.click()}},{key:"clear",value:function(){this.formFileInputs.forEach(function(el){el.innerHTML=""}),this.formUploadInputs.forEach(function(el){el.innerHTML=""})}}])&&feedback_form_upload_defineProperties(Constructor.prototype,protoProps),staticProps&&feedback_form_upload_defineProperties(Constructor,staticProps),FeedbackFormUpload}(),tabs=__webpack_require__(234),content_search_helpers=__webpack_require__(34),emailValidation=function(value){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(value)};__webpack_require__(36),__webpack_require__(166);function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function setFormState_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var setFormState=function(form,nextState){var formInputs=setFormState_toConsumableArray(form.elements);Object.entries(nextState).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1],input=formInputs.find(function(el){return el.name===key});input&&("checkbox"===input.type?input.checked=!0:input.value=value)})},request=__webpack_require__(39);function feedback_form_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function feedback_form_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var feedback_form_FeedbackForm=function(){function FeedbackForm(element,controller){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FeedbackForm),this.form=element,this.controller=controller,this.formInputs=feedback_form_toConsumableArray(this.form.elements),this.formSubmit=this.form.querySelector('[type="submit"]'),this.formAuthType=this.form.querySelector('[name="auth-type"]'),this.formSetAuthType=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-auth-type")),this.socialsAuth=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-social-auth")),this.logout=this.form.querySelector(".js-logout"),this.formMessages=this.form.querySelector(".info-messages"),this.loggedSections=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-comments-logged")),this.notLoggedSections=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-comments-not-logged")),this.hideForGuestSections=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-hide-for-guest")),this.hideForCommentSections=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-hide-for-comment")),this.hideForNewsSections=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-hide-for-news")),this.hideForArticleSections=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-hide-for-articles")),this.hideForInterviewSections=feedback_form_toConsumableArray(this.form.querySelectorAll(".js-hide-for-interview")),this.uploadController=new FeedbackFormUpload(this),this.initTabs(),this.bindEvents(),this.bindModalTriggersEvents()}var Constructor,protoProps,staticProps;return Constructor=FeedbackForm,(protoProps=[{key:"bindEvents",value:function(){var _this=this;this.controller.feedbackModal.addEventListener("hidden.bs.modal-n-2",function(){feedback_form_toConsumableArray(_this.form.querySelectorAll(".input-container-n-2__error")).forEach(function(el){el.innerText=""})}),this.formInputs.forEach(function(el){el.addEventListener("blur",function(){_this.validateField(el,el.name)})}),this.formSetAuthType.forEach(function(el){el.addEventListener("click",function(){var authType=el.getAttribute("data-auth-type");_this.formAuthType.value=authType,_this.hideForGuestSections.forEach(function(element){"guest"===authType?element.classList.add("hidden-n-2"):element.classList.remove("hidden-n-2")})})}),this.socialsAuth.forEach(function(el){el.addEventListener("click",function(event){return event.preventDefault(),_this.handleSocialAuth(el.getAttribute("data-provider"))})}),this.logout.addEventListener("click",function(event){return event.preventDefault(),axios_default.a.get("/ajax/comments_logout.php").then(function(response){response.data.success&&(_this.loggedSections.forEach(function(el){el.classList.add("hidden-n-2")}),_this.notLoggedSections.forEach(function(el){el.classList.remove("hidden-n-2")}),_this.uploadController.clear())})}),this.form.addEventListener("submit",function(event){return event.preventDefault(),_this.handleSubmit()})}},{key:"bindModalTriggersEvents",value:function(){var _this2=this;this.controller.feedbackModalTriggers.forEach(function(el){el.addEventListener("click",function(){var formState={type:el.getAttribute("data-type"),"element-id":el.getAttribute("data-element-id"),review:el.getAttribute("data-review"),"review-top":el.getAttribute("data-review-top")};switch(setFormState(_this2.form,formState),_this2.hideForCommentSections.forEach(function(element){el.hasAttribute("review")?element.classList.add("hidden-n-2"):element.classList.remove("hidden-n-2")}),el.getAttribute("data-type")){case"news":_this2.hideForNewsSections.forEach(function(element){return element.classList.add("hidden-n-2")});break;case"articles":_this2.hideForArticleSections.forEach(function(element){return element.classList.add("hidden-n-2")});break;case"interview":_this2.hideForInterviewSections.forEach(function(element){return element.classList.add("hidden-n-2")})}})})}},{key:"handleSubmit",value:function(){var _this3=this;if(this.formMessages.innerHTML="",this.formInputs.forEach(function(el){_this3.validateField(el,el.name)}),this.error)return!1;this.formSubmit.disabled=!0;var formData=Object(request.a)(Object(content_search_helpers.c)(this.form,{hash:!0}));return feedback_form_toConsumableArray(this.form.querySelectorAll('input[type="file"]')).forEach(function(input){input.files&&feedback_form_toConsumableArray(input.files).forEach(function(file){return formData.append("files_array[]",file)})}),axios_default.a.post("/ajax/comments_send.php",formData).then(function(response){var data=response.data,error=data.error,success=data.success,action=data.action;error?_this3.formMessages.innerHTML=error.reduce(function(acc,value){return acc+value}):success&&(_this3.form.reset(),_this3.controller.onSuccess()),action&&["afterRegister","afterAuth"].includes(action)&&(_this3.loggedSections.forEach(function(el){el.classList.remove("hidden-n-2")}),_this3.notLoggedSections.forEach(function(el){el.classList.add("hidden-n-2")}))}).finally(function(){_this3.formSubmit.disabled=!1})}},{key:"handleSocialAuth",value:function(provider){var _this4=this,dualScreenLeft=window.screenLeft?window.screenLeft:screen.left,dualScreenTop=window.screenTop?window.screenTop:screen.top,left=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-300+dualScreenLeft,top=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-200+dualScreenTop,newWindow=window.open("/ajax/social_auth.php?auth_via="+provider+"&social=entry","Авторизация","scrollbars=yes, width=600, height=400, top="+top+", left="+left);window.focus&&newWindow.focus();var timer=setInterval(function(){newWindow.document.getElementsByClassName("game-account-user__name").length>0&&(newWindow.close(),_this4.loggedSections.forEach(function(element){element.classList.remove("hidden-n-2")}),_this4.notLoggedSections.forEach(function(element){element.classList.add("hidden-n-2")}),_this4.formAuthType.value="social",setTimeout(function(){clearInterval(timer)},100))},200)}},{key:"validateField",value:function(input,name){var _this5=this,inputValue=input.value,validate=function(predicate,onErrorText){predicate?(input.nextElementSibling.innerHTML="",input.closest(".input-container-n-2").classList.remove("input-container-n-2_has_error"),_this5.error=!1):(input.nextElementSibling.innerHTML=onErrorText,input.closest(".input-container-n-2").classList.add("input-container-n-2_has_error"),_this5.error=!0)};switch(name){case"name":validate(inputValue,"Обязательное поле");break;case"register-email":"register"===this.formAuthType.value&&validate(emailValidation(inputValue),"Введите корректный e-mail");break;case"auth-email":"auth"===this.formAuthType.value&&validate(emailValidation(inputValue),"Введите корректный e-mail");break;case"auth-password":"auth"===this.formAuthType.value&&validate(inputValue&&inputValue.length>=8,"Введите минимум 8 символов");break;case"register-password":"register"===this.formAuthType.value&&validate(inputValue&&inputValue.length>=8,"Введите минимум 8 символов");break;case"text":validate(inputValue.length>=10,"Введите минимум 10 символов")}}},{key:"initTabs",value:function(){var tabLinks=feedback_form_toConsumableArray(document.querySelectorAll(".feedback-modal .tabs-links__link"));new tabs.a(tabLinks,{linkClass:"tabs-links__link",tabsClass:"feedback-modal__tab"}).init()}}])&&feedback_form_defineProperties(Constructor.prototype,protoProps),staticProps&&feedback_form_defineProperties(Constructor,staticProps),FeedbackForm}();function star_form_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function star_form_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function star_form_createClass(Constructor,protoProps,staticProps){return protoProps&&star_form_defineProperties(Constructor.prototype,protoProps),staticProps&&star_form_defineProperties(Constructor,staticProps),Constructor}var StarForm=function(){function StarForm(element){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,StarForm),this.element=element,this.input=this.element.querySelector('[name="star"]'),this.resetButton=this.element.nextElementSibling,this.stars=star_form_toConsumableArray(this.element.querySelectorAll(".stars__empty i")),this.fullStars=this.element.querySelector(".stars__full"),this.fullStarsWidth=0,this.bindEvents()}return star_form_createClass(StarForm,null,[{key:"init",value:function(){return star_form_toConsumableArray((arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).querySelectorAll(".js-star-form")).forEach(function(element){new StarForm(element)})}}]),star_form_createClass(StarForm,[{key:"bindEvents",value:function(){var _this=this;this.stars.forEach(function(el,index){el.addEventListener("mouseenter",function(){_this.fullStars.style.width=20*index+20+"%"}),el.addEventListener("click",function(){_this.fullStarsWidth=20*index+20+"%",_this.input.value=index+1})}),this.element.addEventListener("mouseout",function(){_this.fullStars.style.width=_this.fullStarsWidth}),this.resetButton.addEventListener("click",function(event){event.preventDefault(),_this.fullStars.style.width="0%",_this.input.value=0})}}]),StarForm}(),modal=__webpack_require__(105);function reviews_toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function reviews_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function reviews_createClass(Constructor,protoProps,staticProps){return protoProps&&reviews_defineProperties(Constructor.prototype,protoProps),staticProps&&reviews_defineProperties(Constructor,staticProps),Constructor}__webpack_require__.d(__webpack_exports__,"default",function(){return reviews_Reviews});var reviews_Reviews=function(){function Reviews(element){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Reviews),modal.a.init(),this.element=element,this.tabLinks=reviews_toConsumableArray(element.querySelectorAll(".button-item")),this.forms=reviews_toConsumableArray(this.element.querySelectorAll(".answer-form")),this.statusModal=document.querySelector("#modal-status"),this.statusModal&&(this.statusModalContent=this.statusModal.querySelector(".js-modal-status-target")),this.feedbackModal=document.querySelector("#modal-feedback"),this.feedbackModal&&(this.feedbackModalTriggers=reviews_toConsumableArray(document.querySelectorAll('[data-target="#modal-feedback"]')),this.feedbackFormNode=this.feedbackModal.querySelector(".js-feedback-form"),AvatarForm.init(this.feedbackModal),StarForm.init(this.feedbackModal)),this.feedbackFormNode&&(this.feedbackForm=new feedback_form_FeedbackForm(this.feedbackFormNode,this)),this.initTabs(),this.initAnswerForm(),this.initLightGallery()}return reviews_createClass(Reviews,null,[{key:"init",value:function(){var reviews=document.querySelector(".reviews");return reviews?new Reviews(reviews):null}}]),reviews_createClass(Reviews,[{key:"initLightGallery",value:function(){window.lightGallery&&reviews_toConsumableArray(this.element.querySelectorAll(".comments__item__files__body")).forEach(function(el){window.lightGallery(el,{selector:".light_gallery"})})}},{key:"initTabs",value:function(){var _this=this;this.tabLinks.length&&(this.tabs=new tabs.a(this.tabLinks,{linkClass:"button-item",tabsClass:"reviews__tab",beforeChange:function(callElement){var sortType=callElement.getAttribute("href"),reviewsContainer=_this.element.querySelector("".concat(sortType," .reviews-list")),sortedReviews=reviews_toConsumableArray(reviewsContainer.querySelectorAll(".reviews-list__item")).sort(function(a,b){var left,right,direction=1;return"#reviews-order"===sortType?(direction=-1,left=new Date(a.querySelector(".review-n-2__meta").innerText),right=new Date(b.querySelector(".review-n-2__meta").innerText)):"#reviews-popular"===sortType&&(left=parseInt(a.querySelector(".review-vote_like").innerText,10),right=parseInt(b.querySelector(".review-vote_like").innerText,10)),left>right?-direction:left<right?direction:0});reviewsContainer.innerHTML="",sortedReviews.forEach(function(el){reviewsContainer.appendChild(el)})}}),this.tabs.init())}},{key:"initAnswerForm",value:function(){var _this2=this;this.forms.forEach(function(form){form.addEventListener("submit",function(event){event.preventDefault();var formSubmit=form.querySelector('[type="submit"]');formSubmit&&(formSubmit.disabled=!0);var requestData=Object(content_search_helpers.c)(form);return axios_default.a.post("/ajax/comments_send.php",requestData).then(function(response){var data=response.data,error=data.error,success=data.success;"no"===data.user_auth?function(form){var serializedForm=Object(content_search_helpers.c)(form,{hash:!0});_this2.feedbackFormNode&&setFormState(_this2.feedbackForm.form,serializedForm),_this2.feedbackModal.Modal&&_this2.feedbackModal.Modal.show(),form.querySelector('[name="text"]').value=""}(form):error?function(error){_this2.statusModal&&(_this2.statusModalContent.innerHTML=error.reduce(function(acc,value){return acc+value}),_this2.statusModal.Modal.show())}(error):success&&_this2.onSuccess(form)}).finally(function(){formSubmit.disabled=!1})})})}},{key:"onSuccess",value:function(form){form&&(form.querySelector('[name="text"]').value="");this.statusModal&&(this.statusModalContent.innerHTML='\n        <div class="h3">Спасибо за ваш комментарий!</div>\n        <p>После модерации он будет опубликован на сайте</p>\n      ',this.statusModal.Modal.show());try{ym(39897405,"reachGoal","Button_Submit_Feedback")}catch(e){}}}]),Reviews}()}}]);