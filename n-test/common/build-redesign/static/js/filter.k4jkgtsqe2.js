(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{274:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return SearchCounter});__webpack_require__(3),__webpack_require__(7),__webpack_require__(8),__webpack_require__(21),__webpack_require__(9),__webpack_require__(47),__webpack_require__(4),__webpack_require__(12),__webpack_require__(27),__webpack_require__(1),__webpack_require__(2),__webpack_require__(90),__webpack_require__(5),__webpack_require__(36),__webpack_require__(48),__webpack_require__(10),__webpack_require__(6);var axios__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(13),axios__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_17__),query_string__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(49),query_string__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(query_string__WEBPACK_IMPORTED_MODULE_18__),_cookie_cookie__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(32),_helpers_formatTextEndings__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(64),_content_search_content_search_helpers__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(25),_helpers_request__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(60);function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var SearchCounter=function(){function SearchCounter(element){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useCache:!1,customSerialize:null,excludeInputs:[],nextUrl:"",replaceUrl:!0};!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SearchCounter),this.element=element,this.form=element.querySelector("form"),this.url=this.form.getAttribute("action"),this.buttons=_toConsumableArray(element.querySelectorAll(".main-filter-n-2__search-page-button .button-n-2, .map-filter-n-2__search-page-button .button-n-2, .main-filter-n-2__search-button, .main-filter-n-2__search-button-small, .js-search-submit, .js-search-counter")),this.buttonTexts={current:"Найти",default:"Найти"},this.useCache=options.useCache,this.customSerialize="function"==typeof options.customSerialize?options.customSerialize:null,this.cache=null,this.excludeInputs=options.excludeInputs||[],this.nextUrl=options.nextUrl||"",this.replaceUrl=options.replaceUrl,this.requestSource=axios__WEBPACK_IMPORTED_MODULE_17___default.a.CancelToken.source(),this.bindHandlers()}var Constructor,protoProps,staticProps;return Constructor=SearchCounter,(protoProps=[{key:"setButtonContent",value:function(content,loadingState){var _this=this;this.buttonTexts.current=content||this.buttonTexts.default,this.buttons.map(function(button){if("INPUT"===button.nodeName)button.value=_this.buttonTexts.current;else{if(loadingState){button.classList.add("hidden-text");var spinner=document.createElement("span");return spinner.classList.add("spinner"),spinner.classList.add("spinner_ignore-content"),button.innerHTML="",void button.appendChild(spinner)}button.innerText=_this.buttonTexts.current,button.classList.remove("hidden-text")}})}},{key:"cancel",value:function(){this.requestSource.cancel(),this.requestSource=axios__WEBPACK_IMPORTED_MODULE_17___default.a.CancelToken.source()}},{key:"reset",value:function(){this.cache=null,this.setButtonContent(""),this.buttons.forEach(function(button){button.disabled=!1})}},{key:"setState",value:function(state){this.disabled="disabled"===state||!state}},{key:"bindHandlers",value:function(){var _this2=this;this.form&&_toConsumableArray(this.form.elements).forEach(function(input){_this2.excludeInputs.includes(input.name)||input.addEventListener("change",function(){_this2.defferedRequest()})})}},{key:"defferedRequest",value:function(){var _this3=this;this.disabled||(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){return _this3.request()},300))}},{key:"request",value:function(){var _this4=this;window.__SEARCH__&&window.__SEARCH__.geo&&delete window.__SEARCH__.geo;var url=this.url,serializedParams=this.customSerialize?this.customSerialize():this.serialize();this.cache=null,this.setButtonContent(null,!0),this.query=axios__WEBPACK_IMPORTED_MODULE_17___default.a.get(url,{params:serializedParams,paramsSerializer:function(paramsFromArrowFunc){return delete paramsFromArrowFunc["search-counter-ignore"],paramsFromArrowFunc["f[geo][]"]=Object(_helpers_request__WEBPACK_IMPORTED_MODULE_22__.a)(paramsFromArrowFunc["f[geo][]"]),paramsFromArrowFunc["f[metro][]"]=Object(_helpers_request__WEBPACK_IMPORTED_MODULE_22__.a)(paramsFromArrowFunc["f[metro][]"]),query_string__WEBPACK_IMPORTED_MODULE_18___default.a.stringify(paramsFromArrowFunc)},cancelToken:this.requestSource.token}).then(function(response){var data=response.data;if(_this4.replaceUrl){var nextUrl=_this4.nextUrl||""===_this4.nextUrl?_this4.nextUrl:"";history.pushState(serializedParams,"Search-request","".concat(nextUrl,"?").concat(query_string__WEBPACK_IMPORTED_MODULE_18___default.a.stringify(serializedParams)))}_this4.useCache&&(_this4.cache={serializedParams:serializedParams,data:data});var count=data.items_total,nextFormattedText=Object(_helpers_formatTextEndings__WEBPACK_IMPORTED_MODULE_20__.a)(count,"объект",["ов","а",""]);count>0?(_this4.setButtonContent(count>0?"Показать ".concat(count," ").concat(nextFormattedText):""),_this4.buttons.forEach(function(button){button.disabled=!1})):(_this4.setButtonContent("Нет объектов"),_this4.buttons.forEach(function(button){button.disabled=!0}))}).catch(function(){_this4.setButtonContent(_this4.buttonTexts.default)})}},{key:"serialize",value:function(){var cookies=new _cookie_cookie__WEBPACK_IMPORTED_MODULE_19__.a,domainName=location.hostname.split(".")[0],prefix="novostroev"===domainName?"":"".concat(domainName,"-"),geoCookie=cookies.getCookie("".concat(prefix,"geo-city")),cityIds=geoCookie?geoCookie.split(","):[],data=Object(_content_search_content_search_helpers__WEBPACK_IMPORTED_MODULE_21__.b)(this.form,{hash:!0}),priceFrom=data["f[price][from]"],priceTo=data["f[price][to]"];priceFrom&&(data["f[price][from]"]=priceFrom.replace(/\s/g,"")),priceTo&&(data["f[price][to]"]=priceTo.replace(/\s/g,"")),data["f[geo][]"]=[];var advancedGeoParams=_toConsumableArray(this.form.querySelectorAll(".advanced-parametrs-n-2__location-tabs .checkbox-container-n-2__input:checked"));if(advancedGeoParams.length)advancedGeoParams.forEach(function(param){data["f[geo][]"].push(param.getAttribute("data-value"))});else{var activeTabs=_toConsumableArray(this.form.querySelectorAll(".location-city-tab-n-2__input:checked"));activeTabs.length?activeTabs.forEach(function(tab){data["f[geo][]"].push(tab.getAttribute("data-value"))}):cityIds.forEach(function(id){data["f[geo][]"].push(id)})}return data}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),SearchCounter}()},295:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return Filter});__webpack_require__(3),__webpack_require__(7),__webpack_require__(8),__webpack_require__(21),__webpack_require__(59),__webpack_require__(9),__webpack_require__(47),__webpack_require__(4),__webpack_require__(43),__webpack_require__(12),__webpack_require__(101),__webpack_require__(116),__webpack_require__(71),__webpack_require__(91),__webpack_require__(63),__webpack_require__(1),__webpack_require__(42),__webpack_require__(2),__webpack_require__(90),__webpack_require__(5),__webpack_require__(36),__webpack_require__(117),__webpack_require__(10),__webpack_require__(6);var _barba_core__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(283),_barba_core__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(_barba_core__WEBPACK_IMPORTED_MODULE_24__),axios__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(13),axios__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_25__),query_string__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(49),query_string__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(query_string__WEBPACK_IMPORTED_MODULE_26__),perfect_scrollbar__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(44),pubsub_js__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(15),pubsub_js__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(pubsub_js__WEBPACK_IMPORTED_MODULE_28__),_cookie_cookie__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(32),_location_tabs_location_tabs__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(281),_search_counter_search_counter__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(274),_content_search_content_search_helpers__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(25),_form_input_search_input_search_input_helpers__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(122),_helpers_constants__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(11),_search_filter_partials_location_input__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(268);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}_barba_core__WEBPACK_IMPORTED_MODULE_24___default.a.init({prevent:function(_ref){return!_ref.el.hasAttribute("data-pjax")},timeout:1e4,transitions:[{afterEnter:function(data){pubsub_js__WEBPACK_IMPORTED_MODULE_28___default.a.publish(_helpers_constants__WEBPACK_IMPORTED_MODULE_34__.a)}}]});var Filter=function(){function Filter(element){var _this2=this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Filter),this.element=element,this.form=this.element.querySelector(".main-filter-n-2__form"),this.formEndpoints=this.form.getAttribute("action"),this.searchType=this.form.getAttribute("data-search-type")||"buildings",this.pulseDot=element.querySelector(".dot-n-2"),this.mapSearchButtons=_toConsumableArray(element.querySelectorAll(".main-filter-n-2__search-button-small, .filter-slider-wrapper-n-2 .main-filter-n-2__search-on-map .search-on-map")),this.cookie=new _cookie_cookie__WEBPACK_IMPORTED_MODULE_29__.a,this.lastPopup=null,this.closeLastPopup=function(currentPopup){if(_this2.lastPopup&&_this2.lastPopup!==currentPopup)switch(_this2.lastPopup.classList.add("filter-popup-hide-n-2"),_this2.lastPopup){case _this2.selectElement.popup:_this2.selectElement.closePopup();break;case _this2.priceElements.pricePopup:_this2.priceElements.closePopup();break;case _this2.locationElements&&_this2.locationElements.locationTipsWrapper:_this2.locationElements.closePopup()}},Object(_search_filter_partials_location_input__WEBPACK_IMPORTED_MODULE_35__.a)(this.element),this.price(),this.selectElement(),new _location_tabs_location_tabs__WEBPACK_IMPORTED_MODULE_30__.a(this,{customSerialize:function(){return _this2.serialize(null,!0)},modalContainer:".js-geo-detailed",onShow:function(){_this2.searchCounter&&_this2.searchCounter.cache&&(_this2.preSerialize(),_barba_core__WEBPACK_IMPORTED_MODULE_24___default.a.go("".concat(_this2.form.action,"?").concat(query_string__WEBPACK_IMPORTED_MODULE_26___default.a.stringify(_this2.serialize()))))},tabsContainer:".js-geo-detailed-tabs",switchContainer:".js-geo-tabs",switchType:"checkbox"}).then(function(tabs){_this2.tabs=tabs,_this2.element.hasAttribute("data-filter-search")||_this2.element.hasAttribute("data-filter-map")||(_this2.searchCounter=new _search_counter_search_counter__WEBPACK_IMPORTED_MODULE_31__.a(element,{useCache:!0,customSerialize:function(){return _this2.serialize()}}))}),this.bindEvents()}var Constructor,protoProps,staticProps;return Constructor=Filter,(protoProps=[{key:"bindEvents",value:function(){var _this3=this;this.form.addEventListener("submit",function(event){event.preventDefault(),_this3.preSerialize(),_barba_core__WEBPACK_IMPORTED_MODULE_24___default.a.go("".concat(_this3.formEndpoints,"?").concat(query_string__WEBPACK_IMPORTED_MODULE_26___default.a.stringify(_this3.serialize())))}),this.mapSearchButtons.forEach(function(button){button.addEventListener("click",function(event){event.preventDefault(),_this3.preSerialize(),window.location.href="".concat(button.href||button.getAttribute("data-href"),"?").concat(query_string__WEBPACK_IMPORTED_MODULE_26___default.a.stringify(_this3.serialize()))})})}},{key:"preSerialize",value:function(){this.priceElements.inputBefore.value=this.priceElements.inputBefore.value.replace(/\s/g,""),this.priceElements.inputAfter.value=this.priceElements.inputAfter.value.replace(/\s/g,"")}},{key:"serialize",value:function(){var data=Object(_content_search_content_search_helpers__WEBPACK_IMPORTED_MODULE_32__.b)(this.form,{hash:!0}),priceFrom=data["f[price][from]"],priceTo=data["f[price][to]"];return priceFrom&&(data["f[price][from]"]=priceFrom.replace(/\s/g,"")),priceTo&&(data["f[price][to]"]=priceTo.replace(/\s/g,"")),data}},{key:"location",value:function(){var _this4=this;this.locationElements={locationInput:this.element.querySelector(".location-input-n-2 input"),locationTipsWrapper:this.element.querySelector(".location-input-n-2__tips"),locationTips:_toConsumableArray(this.element.querySelectorAll(".location-input-n-2__tips-item")),dynamicLabel:this.element.querySelector(".location-input-n-2__dynamic-label"),bottomLine:this.element.querySelector(".location-input-n-2__bottom-line"),example:this.element.querySelector(".main-filter-n-2__example span"),closePopup:function(){_this4.locationElements.locationTipsWrapper.classList.add("filter-popup-hide-n-2"),_this4.locationElements.bottomLine.classList.remove("location-input-n-2__bottom-line_expanded"),_this4.pulseDot.classList.remove("hide"),""===_this4.locationElements.locationInput.value&&_this4.locationElements.dynamicLabel.classList.remove("location-input-n-2__dynamic-label_lifted")}};var _this$locationElement=this.locationElements,locationInput=_this$locationElement.locationInput,locationTipsWrapper=_this$locationElement.locationTipsWrapper,dynamicLabel=_this$locationElement.dynamicLabel,bottomLine=_this$locationElement.bottomLine,example=_this$locationElement.example,closePopup=_this$locationElement.closePopup,locationTipsContainer=(this.locationElements.locationTips,document.createElement("div"));locationTipsContainer.className="location-input-n-2__tips-container slim-scrollbar",locationTipsWrapper.appendChild(locationTipsContainer),new IntersectionObserver(function(entries,observer){entries[0].isIntersecting&&(new perfect_scrollbar__WEBPACK_IMPORTED_MODULE_27__.a(locationTipsContainer,{suppressScrollX:!0}),observer.disconnect())}).observe(locationTipsContainer);var initTips=function(){_toConsumableArray(_this4.element.querySelectorAll(".location-input-n-2__tips-item")).forEach(function(tip){tip.addEventListener("click",function(){locationInput.value=tip.innerText,locationInput.dispatchEvent(new CustomEvent("change")),closePopup()})})};""!==locationInput.value&&dynamicLabel.classList.add("location-input-n-2__dynamic-label_lifted"),initTips();var templateLabel=function(item,url){return url?'<a href="'.concat(url,'" class="location-input-n-2__tips-item location-input-n-2__tips-item_link">').concat(item,"</a>"):'<span class="location-input-n-2__tips-item">'.concat(item,"</span>")},templateType=function(type){return'<div class="location-input-n-2__tips-category">'.concat(type,"</div>")},requestTips=function(){var searchUrl=locationInput.getAttribute("data-search-url")||"/ajax/text_search_new_buildings.php";return axios__WEBPACK_IMPORTED_MODULE_25___default.a.get(searchUrl,{params:{q:locationInput.value,t:_this4.searchType}}).then(function(res){if(0!==res.data.length){var result=[],types=[];res.data=res.data.map(function(item){return function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}({substring:Object(_form_input_search_input_search_input_helpers__WEBPACK_IMPORTED_MODULE_33__.b)(locationInput.value,item.label)},item)}),res.data=res.data.sort(function(a,b){return a.substring.length<b.substring.length?1:-1}),res.data.forEach(function(item){types.includes(item.type_name)||(types.push(item.type_name),result.push(templateType(item.type_name))),result.push(templateLabel(item.label,item.url))}),locationTipsContainer.innerHTML=result.join(""),initTips()}return res})},requestDefaultTips=function(){var _this=_this4;return new Promise(function(resolve){_this.defaultTips?resolve(_this.defaultTips):axios__WEBPACK_IMPORTED_MODULE_25___default.a.get("text_search_default_tips.json?q=".concat(locationInput.value,"&t=").concat(_this4.searchType)).then(function(res){_this.defaultTips=res,resolve(res),function(res){try{if(0!==res.data.length){var result={},types=[];res.data.forEach(function(item){var type=item.type_name;types.includes(type)||(types.push(type),result[type]=[],result[type].push(templateType(type))),result[type].push(templateLabel(item.label,item.url))}),locationTipsContainer.innerHTML=Object.entries(result).sort(function(a,b){return"cottages"===_this4.searchType?"Область"===a[0]?1:-1:0}).map(function(entry){return entry[1].join("")}).join("")}}catch(e){}}(_this4.defaultTips)})})},openTipsList=function(){_this4.closeLastPopup(locationTipsWrapper),locationTipsWrapper.classList.contains("filter-popup-hide-n-2")&&(_this4.lastPopup=locationTipsWrapper),locationTipsWrapper.classList.remove("filter-popup-hide-n-2"),_this4.pulseDot.classList.add("hide"),""===locationInput.value&&dynamicLabel.classList.add("location-input-n-2__dynamic-label_lifted"),bottomLine.classList.add("location-input-n-2__bottom-line_expanded")},getTips=function(){return 0===locationInput.value.length?requestDefaultTips():requestTips()};locationInput.addEventListener("focus",function(){getTips(),openTipsList()}),document.addEventListener("click",function(e){e.target===locationTipsWrapper||e.target===locationInput||e.target.parentNode===locationTipsWrapper||locationTipsWrapper.classList.contains("hide")||closePopup()}),example&&example.addEventListener("click",function(){locationInput.value=example.textContent,locationInput.dispatchEvent(new CustomEvent("change")),dynamicLabel.classList.add("location-input-n-2__dynamic-label_lifted")}),locationInput.addEventListener("input",function(){_this4.timeout&&clearTimeout(_this4.timeout),_this4.timeout=setTimeout(function(){0===locationInput.value.length?requestDefaultTips():requestTips()},200)}),document.activeElement===locationInput?getTips().then(function(){locationTipsWrapper.classList.contains("filter-popup-hide-n-2")&&openTipsList()}):requestDefaultTips()}},{key:"price",value:function(){var _this5=this;this.priceElements={output:this.element.querySelector(".price-output-n-2"),outputBeforeWrapper:this.element.querySelector(".price-output-n-2__before"),outputAfterWrapper:this.element.querySelector(".price-output-n-2__after"),outputBefore:this.element.querySelector(".price-output-n-2__before span"),outputAfter:this.element.querySelector(".price-output-n-2__after span"),pricePopup:this.element.querySelector(".price-input-n-2__popup"),inputBefore:this.element.querySelector(".price-input-n-2__input-before"),inputAfter:this.element.querySelector(".price-input-n-2__input-after"),suggestBeforeAll:this.element.querySelector(".price-input-n-2__suggest-before"),suggestAfterAll:this.element.querySelector(".price-input-n-2__suggest-after"),crossButtonBefore:this.element.querySelector(".price-input-n-2__input-before-wrapper .price-input-n-2__input-cross"),crossButtonAfter:this.element.querySelector(".price-input-n-2__input-after-wrapper .price-input-n-2__input-cross"),suggestBeforeElements:_toConsumableArray(this.element.querySelectorAll(".price-input-n-2__suggest-before .price-input-n-2__suggest-element")),suggestAfterElements:_toConsumableArray(this.element.querySelectorAll(".price-input-n-2__suggest-after .price-input-n-2__suggest-element")),radioAll:this.element.querySelector(".price-input-n-2__toggle-radio-all"),radioArea:this.element.querySelector(".price-input-n-2__toggle-radio-area"),suggestRowAll:this.element.querySelector(".price-input-n-2__suggest-row"),suggestRowArea:this.element.querySelector(".price-input-n-2__suggest-row-area"),suggestBeforeArea:this.element.querySelector(".price-input-n-2__suggest-row-area .price-input-n-2__suggest-before"),suggestAfterArea:this.element.querySelector(".price-input-n-2__suggest-row-area .price-input-n-2__suggest-after"),dynamicLabel:this.element.querySelector(".price-output-n-2__dynamic-label"),bottomLine:this.element.querySelector(".price-output-n-2__bottom-line"),dropButton:this.element.querySelector(".price-output-n-2__drop-button"),closePopup:function(){_this5.priceElements.pricePopup.classList.add("filter-popup-hide-n-2"),""===_this5.priceElements.inputBefore.value&&""===_this5.priceElements.inputAfter.value&&_this5.priceElements.dynamicLabel.classList.remove("price-output-n-2__dynamic-label_lifted"),_this5.priceElements.bottomLine.classList.remove("price-output-n-2__bottom-line_expanded"),_this5.priceElements.dropButton.classList.remove("price-output-n-2__drop-button_open"),document.removeEventListener("click",clickOutHandle)}};var _this$priceElements=this.priceElements,output=_this$priceElements.output,outputBeforeWrapper=_this$priceElements.outputBeforeWrapper,outputAfterWrapper=_this$priceElements.outputAfterWrapper,outputBefore=_this$priceElements.outputBefore,outputAfter=_this$priceElements.outputAfter,pricePopup=_this$priceElements.pricePopup,inputBefore=_this$priceElements.inputBefore,inputAfter=_this$priceElements.inputAfter,suggestBeforeAll=_this$priceElements.suggestBeforeAll,suggestAfterAll=_this$priceElements.suggestAfterAll,crossButtonBefore=_this$priceElements.crossButtonBefore,crossButtonAfter=_this$priceElements.crossButtonAfter,suggestBeforeElements=_this$priceElements.suggestBeforeElements,suggestAfterElements=_this$priceElements.suggestAfterElements,radioAll=_this$priceElements.radioAll,radioArea=_this$priceElements.radioArea,suggestRowAll=_this$priceElements.suggestRowAll,suggestRowArea=_this$priceElements.suggestRowArea,suggestBeforeArea=_this$priceElements.suggestBeforeArea,suggestAfterArea=_this$priceElements.suggestAfterArea,dynamicLabel=_this$priceElements.dynamicLabel,bottomLine=_this$priceElements.bottomLine,closePopup=_this$priceElements.closePopup,dropButton=_this$priceElements.dropButton,suggestBefore=suggestBeforeAll,suggestAfter=suggestAfterAll,addSpace=function(value){var gettingValue=value.replace(/[^\d]/g,"");return gettingValue.length>10&&(gettingValue=gettingValue.substr(0,10)),gettingValue.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")},changeHandleBefore=function(){var found=!1;_toConsumableArray(document.querySelectorAll(".price-input-n-2__suggest-before .price-input-n-2__suggest-element")).forEach(function(element){element.innerText===inputBefore.value?(element.classList.add("price-input-n-2__suggest-element_selected"),found=!0):element.classList.remove("price-input-n-2__suggest-element_selected"),found?deactivateBefore():activateBefore()}),outputBefore.innerText=inputBefore.value,""!==inputBefore.value?(crossButtonBefore.classList.remove("hide"),outputBeforeWrapper.classList.remove("hide")):(crossButtonBefore.classList.add("hide"),outputBeforeWrapper.classList.add("hide"));var event=document.createEvent("HTMLEvents");event.initEvent("change",!0),inputBefore.dispatchEvent(event)},changeHandleAfter=function(){var found=!1;_toConsumableArray(document.querySelectorAll(".price-input-n-2__suggest-after .price-input-n-2__suggest-element")).forEach(function(element){element.innerText.trim()===inputAfter.value?(element.classList.add("price-input-n-2__suggest-element_selected"),found=!0):element.classList.remove("price-input-n-2__suggest-element_selected"),found?deactivateAfter():activateAfter()}),outputAfter.innerText=inputAfter.value,""!==inputAfter.value?(crossButtonAfter.classList.remove("hide"),outputAfterWrapper.classList.remove("hide")):(crossButtonAfter.classList.add("hide"),outputAfterWrapper.classList.add("hide"));var event=document.createEvent("HTMLEvents");event.initEvent("change",!0),inputAfter.dispatchEvent(event)},suggestInit=function(suggestBefElements,suggestAftElements){suggestBefElements.forEach(function(element){element.addEventListener("click",function(){inputBefore.value=addSpace(element.innerText),inputBefore.dispatchEvent(new CustomEvent("change")),changeHandleBefore(),deactivateBefore()})}),suggestAftElements.forEach(function(element){element.addEventListener("click",function(){inputAfter.value=addSpace(element.innerText),inputAfter.dispatchEvent(new CustomEvent("change")),changeHandleAfter(),deactivateAfter()})})},clearingInputs=function(){inputBefore.value="",inputAfter.value="",inputBefore.dispatchEvent(new CustomEvent("change"))},activateBefore=function(){suggestBefore.classList.remove("price-input-n-2__suggest-before_inactive")},deactivateBefore=function(){suggestBefore.classList.add("price-input-n-2__suggest-before_inactive")},activateAfter=function(){suggestAfter.classList.remove("price-input-n-2__suggest-after_inactive")},deactivateAfter=function(){suggestAfter.classList.add("price-input-n-2__suggest-after_inactive")};radioAll&&radioAll.addEventListener("change",function(){suggestBefore=suggestBeforeAll,suggestAfter=suggestAfterAll,suggestRowAll.classList.remove("hide"),suggestRowArea.classList.add("hide"),clearingInputs(),changeHandleBefore(),changeHandleAfter()}),radioArea&&radioArea.addEventListener("change",function(){suggestBefore=suggestBeforeArea,suggestAfter=suggestAfterArea,suggestRowArea.classList.remove("hide"),suggestRowAll.classList.add("hide"),clearingInputs(),changeHandleBefore(),changeHandleAfter()}),inputBefore.addEventListener("input",function(){inputBefore.value=addSpace(inputBefore.value),changeHandleBefore()}),inputAfter.addEventListener("input",function(){inputAfter.value=addSpace(inputAfter.value),changeHandleAfter()}),crossButtonBefore.addEventListener("click",function(e){e.preventDefault(),e.target.classList.add("hide"),inputBefore.value="",inputBefore.dispatchEvent(new CustomEvent("change")),changeHandleBefore()}),crossButtonAfter.addEventListener("click",function(e){e.preventDefault(),e.target.classList.add("hide"),inputAfter.value="",inputAfter.dispatchEvent(new CustomEvent("change")),changeHandleAfter()});var clickOutHandle=function(e){e.target===output||pricePopup.contains(e.target)||closePopup()},updateSuggest=function(){try{var values={},dataCityTab=document.querySelector(".location-city-tab-n-2.active")?document.querySelector(".location-city-tab-n-2.active").getAttribute("data-city-tab"):"",stage="";if("tab-city-1"===dataCityTab?(stage="msk",values.all={from:[4,5,6,7,8],to:[5,6,8,10,15]},values.area={from:[120,150,200,220,250],to:[180,220,260,290,350]}):(stage="other",values.all={from:[1,2,3,4,5],to:[2,4,6,8,12]},values.area={from:[40,60,80,100,140],to:[60,80,100,120,160]}),_this5.suggestStage===stage)return!0;_this5.suggestStage=stage,printSuggest(values)}catch(e){}},printSuggest=function(values){try{var suggestRAll=_this5.element.querySelector(".price-input-n-2__suggest-row"),suggestRArea=_this5.element.querySelector(".price-input-n-2__suggest-row-area"),suggestRowAllBefore=suggestRAll.querySelector(".price-input-n-2__suggest-before"),suggestRowAllAfter=suggestRAll.querySelector(".price-input-n-2__suggest-after"),suggestRowAreaBefore=null,suggestRowAreaAfter=null;suggestRArea&&(suggestRowAreaBefore=suggestRArea.querySelector(".price-input-n-2__suggest-before"),suggestRowAreaAfter=suggestRArea.querySelector(".price-input-n-2__suggest-after")),suggestRowAllBefore.innerHTML="",values.all.from.forEach(function(element){var div=document.createElement("div");div.classList.add("price-input-n-2__suggest-element"),div.innerHTML="".concat(element," 000 000"),suggestRowAllBefore.appendChild(div)}),suggestRowAllAfter.innerHTML="",values.all.to.forEach(function(element){var div=document.createElement("div");div.classList.add("price-input-n-2__suggest-element"),div.innerHTML="".concat(element," 000 000"),suggestRowAllAfter.appendChild(div)}),suggestRowAreaBefore&&(suggestRowAreaBefore.innerHTML="",values.area.from.forEach(function(element){var div=document.createElement("div");div.classList.add("price-input-n-2__suggest-element"),div.innerHTML="".concat(element," 000"),suggestRowAreaBefore.appendChild(div)})),suggestRowAreaAfter&&(suggestRowAreaAfter.innerHTML="",values.area.to.forEach(function(element){var div=document.createElement("div");div.classList.add("price-input-n-2__suggest-element"),div.innerHTML="".concat(element," 000"),suggestRowAreaAfter.appendChild(div)})),suggestInit(_toConsumableArray(_this5.element.querySelectorAll(".price-input-n-2__suggest-before .price-input-n-2__suggest-element")),_toConsumableArray(_this5.element.querySelectorAll(".price-input-n-2__suggest-after .price-input-n-2__suggest-element")))}catch(e){}};output.addEventListener("click",function(){_this5.closeLastPopup(pricePopup),updateSuggest(),pricePopup.classList.contains("filter-popup-hide-n-2")?(_this5.lastPopup=pricePopup,output.classList.add("price-input-n-2__output_active"),pricePopup.classList.remove("filter-popup-hide-n-2"),dropButton.classList.add("price-output-n-2__drop-button_open"),""===inputBefore.value&&""===inputAfter.value&&dynamicLabel.classList.add("price-output-n-2__dynamic-label_lifted"),document.addEventListener("click",clickOutHandle),bottomLine.classList.add("price-output-n-2__bottom-line_expanded"),setTimeout(function(){inputBefore.focus()},100)):closePopup()}),suggestInit(suggestBeforeElements,suggestAfterElements),updateSuggest()}},{key:"selectElement",value:function(){var _this6=this,focusItemByDirection=function(direction){var nextItem,currentElementIndex=_this6.selectElements.labels.indexOf(document.activeElement);direction===_helpers_constants__WEBPACK_IMPORTED_MODULE_34__.z?currentElementIndex>0&&(nextItem=_this6.selectElements.labels[currentElementIndex-1]):direction===_helpers_constants__WEBPACK_IMPORTED_MODULE_34__.d&&currentElementIndex>=0&&currentElementIndex<_this6.selectElements.labels.length-1&&(nextItem=_this6.selectElements.labels[currentElementIndex+1]),nextItem&&nextItem.focus()},selectCurrentItem=function(){var currentElementIndex=_this6.selectElements.labels.indexOf(document.activeElement);if(currentElementIndex||0===currentElementIndex){var currentInput=_this6.selectElements.checkboxes[currentElementIndex],nextCheckState=!currentInput.checked;if(currentInput.checked=nextCheckState,_this6.selectElements.selectAllPreviousOptions&&0!==currentElementIndex)for(var i=0;i<currentElementIndex;i++)_this6.selectElements.checkboxes[i].checked=nextCheckState;currentInput.dispatchEvent(new CustomEvent("change")),popup.dispatchEvent(new CustomEvent("change"))}};this.selectElements={checked:this.element.querySelector(".filter-select-output-n-2__checked-elements"),extra:this.element.querySelector(".filter-select-output-n-2__extra-tag"),popup:this.element.querySelector(".filter-select-n-2__popup"),output:this.element.querySelector(".filter-select-output-n-2"),cross:this.element.querySelector(".filter-select-n-2__popup-cross"),cancel:this.element.querySelector(".filter-select-n-2__popup-cancel"),apply:this.element.querySelector(".filter-select-n-2__popup-apply"),checkboxes:_toConsumableArray(this.element.querySelectorAll('.filter-select-n-2__popup input[type="checkbox"]')),dynamicLabel:this.element.querySelector(".filter-select-output-n-2__dynamic-label"),bottomLine:this.element.querySelector(".filter-select-output-n-2__bottom-line"),dropButton:this.element.querySelector(".filter-select-output-n-2__drop-button"),transparentLayout:this.element.querySelector(".filter-select-n-2__transparent-layout"),active:[],outputText:null,haveLargeElement:!1,scrollDisable:!1,selectAllPreviousOptions:!0,closePopup:function(){_this6.selectElements.popup.classList.add("filter-popup-hide-n-2"),document.body.classList.remove("no-scroll"),0===_toConsumableArray(_this6.selectElements.popup.querySelectorAll("input:checked")).length&&_this6.selectElements.dynamicLabel.classList.remove("filter-select-output-n-2__dynamic-label_lifted"),_this6.selectElements.bottomLine.classList.remove("filter-select-output-n-2__bottom-line_expanded"),_this6.selectElements.dropButton.classList.remove("filter-select-output-n-2__drop-button_open"),_this6.selectElements.transparentLayout.classList.add("hide"),document.removeEventListener("click",clickOutHandle)}},this.selectElements.labels=this.selectElements.checkboxes.map(function(item){return item.nextElementSibling});var _this$selectElements=this.selectElements,checked=_this$selectElements.checked,extra=_this$selectElements.extra,popup=_this$selectElements.popup,output=_this$selectElements.output,cross=_this$selectElements.cross,cancel=_this$selectElements.cancel,apply=_this$selectElements.apply,checkboxes=_this$selectElements.checkboxes,labels=_this$selectElements.labels,dynamicLabel=_this$selectElements.dynamicLabel,bottomLine=_this$selectElements.bottomLine,closePopup=_this$selectElements.closePopup,dropButton=_this$selectElements.dropButton,transparentLayout=_this$selectElements.transparentLayout,_this$selectElements2=this.selectElements,active=_this$selectElements2.active,outputText=_this$selectElements2.outputText,haveLargeElement=_this$selectElements2.haveLargeElement;output.hasAttribute("tabindex")||output.setAttribute("tabindex",0),output.addEventListener("keydown",function(event){switch(event.keyCode){case _helpers_constants__WEBPACK_IMPORTED_MODULE_34__.d:return event.preventDefault(),void(labels&&labels.length&&labels[0].focus());case _helpers_constants__WEBPACK_IMPORTED_MODULE_34__.f:return void closePopup();default:return}}),popup.addEventListener("change",function(event){var activeElements=popup.querySelectorAll("input:checked");active=[],_toConsumableArray(activeElements).forEach(function(activeElement){active.push(activeElement.getAttribute("data-value")),activeElement.hasAttribute("data-large")&&(haveLargeElement=!0)}),active=active.sort();var setOutputText=function(text){outputText=activeElements.length===checkboxes.length?"Все":text};activeElements.length<2&&!haveLargeElement?(extra.classList.add("filter-select-output-n-2__extra-tag_hidden"),setOutputText(active.join(", "))):1===active.length&&haveLargeElement?(extra.classList.add("filter-select-output-n-2__extra-tag_hidden"),setOutputText(active[0])):(extra.classList.remove("filter-select-output-n-2__extra-tag_hidden"),extra.innerText=active.length,setOutputText(event.srcElement.checked?event.srcElement.getAttribute("data-value"):active[active.length-1])),0!==activeElements.length?(dynamicLabel.classList.add("filter-select-output-n-2__dynamic-label_lifted"),checked.innerText=outputText):(checked.innerText="",extra.classList.add("filter-select-output-n-2__extra-tag_hidden"),dynamicLabel.classList.remove("filter-select-output-n-2__dynamic-label_lifted"))}),transparentLayout.addEventListener("click",closePopup);var clickOutHandle=function(e){e.target===output||popup.contains(e.target)||closePopup()};output.addEventListener("click",function(){_this6.closeLastPopup(popup),popup.classList.contains("filter-popup-hide-n-2")?(_this6.lastPopup=popup,bottomLine.classList.add("filter-select-output-n-2__bottom-line_expanded"),popup.classList.remove("filter-popup-hide-n-2"),document.documentElement.clientWidth<768&&document.body.classList.add("no-scroll"),dropButton.classList.add("filter-select-output-n-2__drop-button_open"),dynamicLabel.classList.add("filter-select-output-n-2__dynamic-label_lifted"),transparentLayout.classList.remove("hide"),output.focus(),document.addEventListener("click",clickOutHandle)):closePopup()}),cancel.addEventListener("click",function(e){e.preventDefault(),checkboxes.forEach(function(checkbox){checkbox.checked=!1}),checked.innerText="",extra.innerText="",active.splice(0,active.length),closePopup()}),apply.addEventListener("click",function(e){e.preventDefault(),closePopup()}),cross.addEventListener("click",function(e){e.preventDefault(),closePopup()}),labels.forEach(function(item){item.setAttribute("tabindex",0),item.addEventListener("keydown",function(event){switch(event.stopPropagation(),event.keyCode){case _helpers_constants__WEBPACK_IMPORTED_MODULE_34__.e:return void selectCurrentItem();case _helpers_constants__WEBPACK_IMPORTED_MODULE_34__.d:return event.preventDefault(),void focusItemByDirection(_helpers_constants__WEBPACK_IMPORTED_MODULE_34__.d);case _helpers_constants__WEBPACK_IMPORTED_MODULE_34__.z:return event.preventDefault(),void focusItemByDirection(_helpers_constants__WEBPACK_IMPORTED_MODULE_34__.z);case _helpers_constants__WEBPACK_IMPORTED_MODULE_34__.f:return void closePopup();default:return void(_helpers_constants__WEBPACK_IMPORTED_MODULE_34__.y.includes(event.keyCode)&&(event.preventDefault(),selectCurrentItem()))}})})}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Filter}()}}]);