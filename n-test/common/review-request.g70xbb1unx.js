(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{296:function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return m});r(0),r(37),r(90),r(116);var n=r(13),i=r.n(n),o=r(86),a=r(23),s=r(59);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t,this.modal=new o.a.Modal(this.element),this.title=this.element.querySelector(".h3"),this.form=this.element.querySelector(".js-review-modal-form"),this.formStatus=this.element.querySelector(".js-review-modal-status"),this.formHiddenType=this.element.querySelector('[name="type"]'),this.formBuildingPlace=this.element.querySelector('[name="new_building_place"]'),this.formPhone=this.element.querySelector('[name="phone"]'),this.formEmail=this.element.querySelector('[name="email"]'),this.formSubmitButton=this.form.querySelector('[type="submit"]'),this.errorsContainer=document.createElement("div"),this.errorsContainer.className="modal-review__errors",this.url=this.form.getAttribute("action"),this.bindEvents()}var t,r,n;return t=e,(r=[{key:"bindEvents",value:function(){var e=this;this.element.addEventListener("show.bs.modal-n-2",function(){var t=e.element.modalTrigger;if(t.hasAttribute("data-form")){var r=t.getAttribute("data-form");e.formHiddenType.value=r,"review"===r?(e.formBuildingPlace.removeAttribute("required"),e.formBuildingPlace.closest(".form__control").classList.add("hidden"),e.formPhone.removeAttribute("required"),e.formPhone.closest(".form__control").classList.add("hidden"),e.formEmail.removeAttribute("required"),e.formEmail.closest(".form__control").querySelector(".labeled-input__meta").innerText="после съемки авторского обзора мы оповестим Вас по почте"):e.formEmail.closest(".form__control").querySelector(".labeled-input__meta").innerText="после выполнения задания вышлем видео Вам на почту"}t.hasAttribute("data-form-title")&&(e.title.innerText=t.getAttribute("data-form-title")),e.recaptchaLoaded||e.loadRecaptcha()}),this.form.addEventListener("submit",function(t){return t.preventDefault(),e.formSubmitButton.disabled=!0,e.request()})}},{key:"request",value:function(){var e=this,t=function(t){e.errorsContainer.parentNode&&e.errorsContainer.parentNode.removeChild(e.errorsContainer),e.errorsContainer.innerHTML=t,e.formSubmitButton.parentNode.insertBefore(e.errorsContainer,e.formSubmitButton)};return this.setSpinnerState(!0),i.a.post(this.url,Object(s.b)(Object(a.b)(this.form,{hash:!0}))).then(function(r){var n=r.data;"success"===n.trim()?(e.formStatus.innerText="Спасибо, ваша ".concat(e.title.innerText.toLowerCase()," отправлена, мы свяжемся с вами в ближайшее время"),e.form.style.display="none",setTimeout(function(){e.modal.hide()},5e3)):"captcha"===n.trim()?t("Проверьте правильность ввода капчи"):t(n)}).catch(function(){return e.formStatus.innerText="Ошибка при отправке, свяжитесь с нами по телефону +7 (495) 662-97-55",void(e.form.style.display="none")}).finally(function(){window.grecaptcha&&window.grecaptcha.reset(),e.setSpinnerState(!1),e.formSubmitButton.disabled=!1})}},{key:"setSpinnerState",value:function(e){if(e){var t=document.createElement("span");t.classList.add("spinner"),t.classList.add("spinner_ignore-content"),this.formSubmitButton.innerHTML="",this.formSubmitButton.appendChild(t)}else this.formSubmitButton.innerHTML="Отправить"}},{key:"loadRecaptcha",value:function(){var e=document.createElement("script");e.async=!0,e.src="//www.google.com/recaptcha/api.js",document.body.appendChild(e),this.recaptchaLoaded=!0}}])&&l(t.prototype,r),n&&l(t,n),e}()}}]);