(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{349:function(module,exports){},351:function(module,exports){},388:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return BooksReader});__webpack_require__(99),__webpack_require__(83),__webpack_require__(103),__webpack_require__(34),__webpack_require__(84),__webpack_require__(102),__webpack_require__(11);var epubjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(313),moveto__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(36),moveto__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(moveto__WEBPACK_IMPORTED_MODULE_8__),_accordion_accordion__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(113),_sticky_container_sticky_container__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(159);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var DEFAULT_FONT_SIZE=16,BooksReader=function(){function BooksReader(element){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BooksReader),this.element=element,this.bookSrc=element.getAttribute("data-book-src"),this.bookSrc&&(this.moveTo=new moveto__WEBPACK_IMPORTED_MODULE_8___default.a,this.bookUrl=element.getAttribute("data-book-url"),this.isPreview=element.getAttribute("data-book-preview"),this.bookContent=document.querySelector(".js-book-content"),this.bookPagination=document.querySelector(".js-book-pagination"),this.bookRender=document.querySelector(".js-book-render"),this.bookControls=document.querySelector(".js-book-controls"),this.bookSidebar=document.querySelector(".js-book-sidebar"),this.mobileOverlay=document.querySelector(".js-mobile-overlay"),this.mobileCloseButton=document.querySelector(".js-book-content-close"),this.mobileOpenButton=document.querySelector(".js-book-content-open"),this.bookControls&&(this.currentFontSize=DEFAULT_FONT_SIZE,this.bookFontIncrease=this.bookControls.querySelector(".js-font-increase"),this.bookFontDecrease=this.bookControls.querySelector(".js-font-decrease"),this.bookFontReset=this.bookControls.querySelector(".js-font-reset")),this.init())}var Constructor,protoProps,staticProps;return Constructor=BooksReader,(protoProps=[{key:"init",value:function(){var _this=this;this.book=Object(epubjs__WEBPACK_IMPORTED_MODULE_7__.a)(this.bookSrc,{history:!1}),this.bookRenderOutput=document.createElement("div"),this.bookRenderOutput.className="book-preview__output",this.bookRenderHidden=document.createElement("div"),this.bookRenderHidden.className="book-preview__hidden",this.bookRender.appendChild(this.bookRenderOutput),this.bookRender.appendChild(this.bookRenderHidden),this.rendition=this.book.renderTo(this.bookRenderHidden,{method:"continuous",spread:"none",width:"100%"}),this.rendition.hooks.content.register(function(){return _this.renderContent()}),this.rendition.themes.font("Roboto"),this.rendition.themes.fontSize(DEFAULT_FONT_SIZE+"px"),this.rendition.themes.default({".title1, h1":{"font-size":"1.275em","font-weight":700},".title2, h2":{"font-size":"1.214em","font-weight":700},".title3, h3":{"font-size":"1.143em","font-weight":700},".title4, h4":{"font-size":"1.07em","font-weight":700},".title5, h5":{"font-size":"1em","font-weight":700},".title6, h6":{"font-size":"1em","font-weight":700},".p1, p":{"font-size":"1em","line-height":"1.5",color:"#071321","margin-bottom":"1.25em !important","text-indent":"0 !important"},body:{padding:"1.8em 0 1.8em 0 !important","margin-top":"-1.8em !important"}}),this.bindEvents(),window.reader=this.book}},{key:"handleBookReady",value:function(){var firstPage=0,spine=this.book.locations.spine;if(spine){var spineItems=spine.spineItems;if(spineItems&&Array.isArray(spineItems)){var firstContentPages=spineItems.filter(function(item){return!item.idref.includes("cover")});firstContentPages.length>0&&(firstPage=firstContentPages[0]===spineItems[0]?firstContentPages.length>4?firstContentPages[4].href:firstContentPages[1].href:firstContentPages[0].href)}}this.displayed=this.rendition.display(firstPage)}},{key:"bindEvents",value:function(){var _this2=this;window.addEventListener("resize",function(){_this2.handleBookReady()}),this.book.ready.then(function(){_this2.handleBookReady(),_this2.generateNavigation(),_this2.isPreview||_this2.generatePagination()}),this.bookControls&&(this.bookFontIncrease.addEventListener("click",function(){_this2.rendition.themes.fontSize(++_this2.currentFontSize+"px")}),this.bookFontDecrease.addEventListener("click",function(){_this2.rendition.themes.fontSize(--_this2.currentFontSize+"px")}),this.bookFontReset.addEventListener("click",function(){_this2.rendition.themes.fontSize(DEFAULT_FONT_SIZE+"px"),_this2.currentFontSize=DEFAULT_FONT_SIZE})),this.bookSidebar&&(this.mobileOverlay&&this.mobileOverlay.addEventListener("click",function(){_this2.bookSidebar.classList.remove("is-open")}),this.mobileCloseButton&&this.mobileCloseButton.addEventListener("click",function(){_this2.bookSidebar.classList.remove("is-open")}),this.mobileOpenButton&&this.mobileOpenButton.addEventListener("click",function(){_this2.bookSidebar.classList.add("is-open")}))}},{key:"bindContentEvents",value:function(links){var _this3=this;links.forEach(function(link){link.addEventListener("click",function(e){e.preventDefault();var href=link.getAttribute("href");href&&_this3.rendition.display(href).then(function(){var id=href.split("#")[1];if(id){var target=_this3.bookRenderOutput.querySelector("#"+id);target?_this3.moveTo.move(target):_this3.moveTo.move(_this3.bookRenderOutput)}else _this3.moveTo.move(_this3.bookRenderOutput)})})})}},{key:"generateNavigation",value:function(){var _this4=this;if(this.bookContent){var navigation=this.book.navigation.toc,chapterLinks=[];if(navigation&&navigation.length){var contentList=document.createElement("ul");contentList.className="content-table__list",navigation.forEach(function(item){var contentItem=document.createElement("li");contentItem.className="content-table__list-item";var contentItemName=document.createElement("a");if(contentItemName.className="content-table__list-item-name link-n-2 js-book-chapter",contentItemName.setAttribute("data-accordion",item.id),contentItemName.setAttribute("data-accordion-parent",".content-table__list-item_nested"),contentItemName.href=_this4.isPreview?_this4.bookUrl:item.href,contentItemName.innerText=item.label.trim().replace("\n","").replace(/^\d+.[\s]*/,""),contentItem.appendChild(contentItemName),chapterLinks.push(contentItemName),item.subitems.length){contentItem.classList.add("content-table__list-item_nested");var contentSubitemsList=document.createElement("ol");contentSubitemsList.className="content-table__list accordion-n-2",contentSubitemsList.id=item.id,item.subitems.forEach(function(subitem){var contentSubitem=document.createElement("li");contentSubitem.className="content-table__list-item";var contentSubitemLink=document.createElement("a");contentSubitemLink.className="link-n-2 js-book-chapter",contentSubitemLink.innerText=subitem.label.trim().replace("\n","").replace(/^\d+.[\s]*/,""),contentSubitemLink.href=_this4.isPreview?_this4.bookUrl:subitem.href,chapterLinks.push(contentSubitemLink),contentSubitem.appendChild(contentSubitemLink),contentSubitemsList.appendChild(contentSubitem)}),contentItem.appendChild(contentSubitemsList)}contentList.appendChild(contentItem)}),this.bookContent.appendChild(contentList),this.isPreview||(this.bindContentEvents(chapterLinks),_accordion_accordion__WEBPACK_IMPORTED_MODULE_9__.a.init())}else{var counter=1;this.book.spine.each(function(element,index){0===index?"В начало":1===index?"Оглавление":index===_this4.book.spine.length-1?"В конец":("Часть ".concat(counter),counter++)})}}}},{key:"generatePagination",value:function(){var _this5=this,paginationStickyContainer=document.createElement("div");paginationStickyContainer.className="book-pagination-controls";var paginationWrapper=document.createElement("div");paginationWrapper.className="pagination-n-2",paginationWrapper.setAttribute("data-sticky-container",""),paginationWrapper.setAttribute("data-sticky-mobile",""),paginationWrapper.setAttribute("data-sticky-bottom","");var paginationPrev=document.createElement("div");paginationPrev.className="pagination-n-2__prev";var paginationPrevButton=document.createElement("button");paginationPrevButton.className="button-n-2 button-n-2_type_small button-n-2_white",paginationPrevButton.innerText="Назад",paginationPrev.appendChild(paginationPrevButton);var paginationNext=document.createElement("div");paginationNext.className="pagination-n-2__next";var paginationNextButton=document.createElement("button");paginationNextButton.className="button-n-2 button-n-2_type_small button-n-2_white",paginationNextButton.innerText="Вперед",paginationNext.appendChild(paginationNextButton),paginationWrapper.appendChild(paginationPrev),paginationWrapper.appendChild(paginationNext),paginationPrevButton.addEventListener("click",function(){_this5.rendition.prev(),_this5.moveTo.move(_this5.bookRender,{tolerance:20})}),paginationNextButton.addEventListener("click",function(){_this5.rendition.next(),_this5.moveTo.move(_this5.bookRender,{tolerance:20})}),paginationStickyContainer.appendChild(paginationWrapper),this.element.appendChild(paginationStickyContainer),_sticky_container_sticky_container__WEBPACK_IMPORTED_MODULE_10__.a.init(this.element)}},{key:"renderContent",value:function(){this.book.rendition.getContents().forEach(function(content){var fontLink=content.document.createElement("link");fontLink.setAttribute("rel","stylesheet"),fontLink.setAttribute("href","https://fonts.googleapis.com/css?family=Roboto"),content.document.head.appendChild(fontLink)})}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),BooksReader}()}}]);